<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>BLAST Results</title>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
  </head>
  <body>
    <div class="bk-root" id="02b01f92-eed3-40d7-9a63-7d72719eb694" data-root-id="1135"></div>
  
    <script type="application/json" id="1292">
      {"cd4879f6-e1af-4619-82c3-d0685a686b47":{"defs":[],"roots":{"references":[{"attributes":{"end":1171.0,"js_property_callbacks":{"change:value":[{"id":"1085"},{"id":"1086"}]},"start":0,"title":"Bitscore Range Slider","value":[108.0,1063.0]},"id":"1081","type":"RangeSlider"},{"attributes":{},"id":"1029","type":"RedoTool"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1075"}]},"options":["Cyanobacteriota"],"title":"Select: Phylum","value":["Cyanobacteriota"]},"id":"1066","type":"MultiSelect"},{"attributes":{"high":60,"js_property_callbacks":{"change:value":[{"id":"1088"}]},"low":0,"step":5,"title":"Circle size","value":10,"value_throttled":10,"width":200},"id":"1082","type":"Spinner"},{"attributes":{},"id":"1059","type":"UnionRenderers"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1065"}]},"options":["phylum","class","order","family","genus"],"title":"Select Legend Color","value":"family"},"id":"1064","type":"Select"},{"attributes":{},"id":"1028","type":"UndoTool"},{"attributes":{},"id":"1008","type":"DataRange1d"},{"attributes":{},"id":"1060","type":"Selection"},{"attributes":{},"id":"1014","type":"LinearScale"},{"attributes":{"high":20,"js_property_callbacks":{"change:value":[{"id":"1087"}]},"low":0,"title":"Circle line size","value":1,"value_throttled":1,"width":200},"id":"1083","type":"Spinner"},{"attributes":{"args":{"other":{"id":"1008"}},"code":"other.start = this.value[0]"},"id":"1085","type":"CustomJS"},{"attributes":{"args":{"other":{"id":"1047"}},"code":"other.line_width = this.value"},"id":"1087","type":"CustomJS"},{"attributes":{},"id":"1030","type":"WheelZoomTool"},{"attributes":{"args":{"other":{"id":"1008"}},"code":"other.end = this.value[1]"},"id":"1086","type":"CustomJS"},{"attributes":{"coordinates":null,"glyph_height":40,"glyph_width":40,"group":null,"items":[{"id":"1063"}]},"id":"1045","type":"Legend"},{"attributes":{"args":{"sc":{"id":"1003"},"tax_unit":"family"},"code":"\n            var temp = []\n            var csvFileData = []\n            \n            if(sc.selected.indices.length != 0){\n                for(var i = 0; i &lt; sc.data.length; i++){\n                    temp = [sc.data['qseqid'][sc.selected.indices[i]],\n                            sc.data['sacc'][sc.selected.indices[i]],\n                            sc.data['staxids'][sc.selected.indices[i]]]\n                    csvFileData.push(temp)\n                }\n            } else {\n                for(var i = 0; i &lt; sc.data['sacc'].length; i++){\n                    temp = [sc.data['qseqid'][i],\n                            sc.data['sacc'][i],\n                            sc.data['staxids'][i]]\n                    csvFileData.push(temp);\n                }                          \n            } \n            \n            //define the heading for each row of the data  \n            var csv = `qseqid,sacc,staxids\n`;  \n            //merge the data with CSV  \n            csvFileData.forEach(function(row) {  \n                    csv += row.join(',');  \n                    csv += `\n`;  \n            });  \n            var json = JSON.stringify(csv);\n            var file = new File([csv], \"selection.csv\" ,{type: \"octet/stream\"});\n            var url = URL.createObjectURL(file);\n            window.location.assign(url);\n        "},"id":"1090","type":"CustomJS"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1076"}]},"options":["Cyanophyceae"],"title":"Select: Class","value":["Cyanophyceae"]},"id":"1067","type":"MultiSelect"},{"attributes":{"tools":[{"id":"1024"},{"id":"1025"},{"id":"1026"},{"id":"1027"},{"id":"1028"},{"id":"1029"},{"id":"1030"},{"id":"1031"},{"id":"1034"}]},"id":"1035","type":"Toolbar"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1078"}]},"options":["Acaryochloridaceae","Aphanothecaceae","Cyanothecaceae","Geminocystaceae","Merismopediaceae","Microcoleaceae","Microcystaceae","Nostocaceae","Prochlorococcaceae","Synechococcaceae","Thermostichaceae","Thermosynechococcaceae"],"title":"Select: Family","value":["Acaryochloridaceae","Aphanothecaceae"]},"id":"1069","type":"MultiSelect"},{"attributes":{},"id":"1017","type":"BasicTicker"},{"attributes":{"args":{"other":{"id":"1047"}},"code":"other.size = this.value"},"id":"1088","type":"CustomJS"},{"attributes":{},"id":"1112","type":"UnionRenderers"},{"attributes":{"coordinates":null,"group":null,"text":"Number of RBHs - pident vs bitscore"},"id":"1006","type":"Title"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1077"}]},"options":["Acaryochloridales","Chroococcales","Gomontiellales","Synechococcales","Oscillatoriales","Nostocales","Thermostichales"],"title":"Select: Order","value":["Acaryochloridales","Chroococcales"]},"id":"1068","type":"MultiSelect"},{"attributes":{"below":[{"id":"1016"}],"center":[{"id":"1019"},{"id":"1023"}],"height":700,"left":[{"id":"1020"},{"id":"1045"}],"renderers":[{"id":"1050"}],"title":{"id":"1006"},"toolbar":{"id":"1035"},"toolbar_location":null,"width":900,"x_range":{"id":"1008"},"x_scale":{"id":"1012"},"y_range":{"id":"1010"},"y_scale":{"id":"1014"}},"id":"1005","subtype":"Figure","type":"Plot"},{"attributes":{"icon":null,"js_event_callbacks":{"button_click":[{"id":"1090"}]},"label":"Download Selection"},"id":"1091","type":"Button"},{"attributes":{},"id":"1113","type":"Selection"},{"attributes":{"label":{"field":"family"},"renderers":[{"id":"1050"}]},"id":"1063","type":"LegendItem"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"color"},"hatch_alpha":{"value":0.1},"hatch_color":{"field":"color"},"line_alpha":{"value":0.1},"marker":{"field":"marker"},"size":{"value":10},"x":{"field":"x"},"y":{"field":"y"}},"id":"1048","type":"Scatter"},{"attributes":{"fill_color":{"field":"color"},"hatch_color":{"field":"color"},"marker":{"field":"marker"},"size":{"value":10},"x":{"field":"x"},"y":{"field":"y"}},"id":"1047","type":"Scatter"},{"attributes":{"args":{"remote_or_local":"remote","sc":{"id":"1003"}},"code":"\n        var viewData = { \n            accessions : [],\n            url : window.location.href\n        };\n        var jsonData = {};\n        \n        if(sc.selected.indices.length != 0){\n            for(var i = 0; i &lt; sc.selected.indices.length; i++){\n                jsonData[i] = sc.data['sacc'][sc.selected.indices[i]]\n            }        \n        } else {\n            for(var i = 0; i &lt; sc.data['sacc'].length; i++){\n                jsonData[i] = sc.data['sacc'][i]                         \n            } \n        }\n\n\n        viewData.accessions.push(jsonData);\n\n        var json = JSON.stringify(viewData);\n        \n        var base_url = window.location.href\n        base_url = base_url.split(\"/\")[2]\n        base_url = \"http://\" + base_url\n        $.ajax({\n            type: \"POST\",\n            url: base_url,\n            data: json,\n            success: function(result){\n                setTimeout(function(){\n                   window.location.reload();\n                }, 2000);\n            },\n            dataType: \"json\"\n        });\n\n\n    "},"id":"1092","type":"CustomJS"},{"attributes":{"icon":null,"js_event_callbacks":{"button_click":[{"id":"1092"}]},"label":"Selection Constrained Phylogeny"},"id":"1093","type":"Button","disabled":true},{"attributes":{"coordinates":null,"data_source":{"id":"1003"},"glyph":{"id":"1047"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"1049"},"nonselection_glyph":{"id":"1048"},"view":{"id":"1051"}},"id":"1050","type":"GlyphRenderer"},{"attributes":{"source":{"id":"1003"}},"id":"1051","type":"CDSView"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1079"}]},"options":["Acaryochloris","Gloeothece","Rippkaea","Cyanothece","Picosynechococcus","Synechocystis","Trichodesmium","Microcystis","Trichormus","Nostoc","Prochlorococcus","Parasynechococcus","Synechococcus","Thermostichus","Thermosynechococcus"],"title":"Select: Genus","value":["Acaryochloris","Gloeothece"]},"id":"1070","type":"MultiSelect"},{"attributes":{"args":{"color_menu":{"id":"1064"},"pals":{"10":["#5e4fa2","#3288bd","#66c2a5","#abdda4","#e6f598","#fee08b","#fdae61","#f46d43","#d53e4f","#9e0142"],"11":["#5e4fa2","#3288bd","#66c2a5","#abdda4","#e6f598","#ffffbf","#fee08b","#fdae61","#f46d43","#d53e4f","#9e0142"],"3":["#99d594","#ffffbf","#fc8d59"],"4":["#2b83ba","#abdda4","#fdae61","#d7191c"],"5":["#2b83ba","#abdda4","#ffffbf","#fdae61","#d7191c"],"6":["#3288bd","#99d594","#e6f598","#fee08b","#fc8d59","#d53e4f"],"7":["#3288bd","#99d594","#e6f598","#ffffbf","#fee08b","#fc8d59","#d53e4f"],"8":["#3288bd","#66c2a5","#abdda4","#e6f598","#fee08b","#fdae61","#f46d43","#d53e4f"],"9":["#3288bd","#66c2a5","#abdda4","#e6f598","#ffffbf","#fee08b","#fdae61","#f46d43","#d53e4f"]},"sc":{"id":"1003"},"tax_menu":{"class":["Cyanophyceae"],"family":["Merismopediaceae","Geminocystaceae","Acaryochloridaceae","Thermosynechococcaceae","Thermostichaceae","Synechococcaceae","Prochlorococcaceae","Nostocaceae","Microcystaceae","Aphanothecaceae","Microcoleaceae","Cyanothecaceae"],"genus":["Synechocystis","Picosynechococcus","Acaryochloris","Thermosynechococcus","Thermostichus","Synechococcus","Parasynechococcus","Nostoc","Microcystis","Gloeothece","Rippkaea","Trichodesmium","Trichormus","Cyanothece","Prochlorococcus"],"order":["Synechococcales","Chroococcales","Acaryochloridales","Thermostichales","Nostocales","Oscillatoriales","Gomontiellales"],"phylum":["Cyanobacteriota"]}},"code":"\n        // the callback value is a number 3,4,5,6,7,8,9,10,11,12\n        var call_back_object = cb_obj.value\n\n        var unique_organisms = []\n\n\n        for(var i = 0; i&lt;sc.get_length(); i++){\n            if(unique_organisms.includes(sc.data[color_menu.value][i]) == false){\n                unique_organisms.push(sc.data[color_menu.value][i])\n            }\n        }\n\n        if(unique_organisms.length &lt;= pals[call_back_object].length){\n            var color_dict = {}\n            for(var i = 0; i &lt; unique_organisms.length; i++){\n                if(i == pals[call_back_object].length){\n                    i = 0\n                }\n                color_dict[unique_organisms[i]] = pals[call_back_object][i]\n            }\n            sc.data['color'] = []\n            for(var i = 0; i&lt;sc.data[color_menu.value].length; i++){\n                sc.data['color'].push(color_dict[sc.data[color_menu.value][i]])\n            }\n         sc.change.emit();\n         }\n        "},"id":"1095","type":"CustomJS"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"field":"color"},"hatch_alpha":{"value":0.2},"hatch_color":{"field":"color"},"line_alpha":{"value":0.2},"marker":{"field":"marker"},"size":{"value":10},"x":{"field":"x"},"y":{"field":"y"}},"id":"1049","type":"Scatter"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1095"}]},"options":[["3","Spectral3"],["4","Spectral4"],["5","Spectral5"],["6","Spectral6"],["7","Spectral7"],["8","Spectral8"],["9","Spectral9"],["10","Spectral10"],["11","Spectral11"]],"title":"Select a color palette","value":"3"},"id":"1094","type":"Select"},{"attributes":{"args":{"color_dict":{"Acaryochloridaceae":"#a1c9f4","Acaryochloridales":"#a1c9f4","Acaryochloris":"#a1c9f4","Aphanothecaceae":"#ffb482","Chroococcales":"#ffb482","Cyanobacteriota":"#a1c9f4","Cyanophyceae":"#a1c9f4","Cyanothecaceae":"#8de5a1","Cyanothece":"#ff9f9b","Geminocystaceae":"#ff9f9b","Gloeothece":"#ffb482","Gomontiellales":"#8de5a1","Merismopediaceae":"#d0bbff","Microcoleaceae":"#debb9b","Microcystaceae":"#fab0e4","Microcystis":"#cfcfcf","Nostoc":"#b9f2f0","Nostocaceae":"#cfcfcf","Nostocales":"#debb9b","Oscillatoriales":"#d0bbff","Parasynechococcus":"#ffb482","Picosynechococcus":"#d0bbff","Prochlorococcaceae":"#fffea3","Prochlorococcus":"#a1c9f4","Rippkaea":"#8de5a1","Synechococcaceae":"#b9f2f0","Synechococcales":"#ff9f9b","Synechococcus":"#8de5a1","Synechocystis":"#debb9b","Thermostichaceae":"#a1c9f4","Thermostichales":"#fab0e4","Thermostichus":"#ff9f9b","Thermosynechococcaceae":"#ffb482","Thermosynechococcus":"#d0bbff","Trichodesmium":"#fab0e4","Trichormus":"#fffea3"},"legend":{"id":"1063"},"menu_qseqids":{"id":"1004"},"sc":{"id":"1003"},"source":{"id":"1002"}},"code":"  \n                    var tax_unit = cb_obj.value\n\n                    legend.label = {'field':tax_unit}\n                    var length = sc.get_length()\n                    sc.data['color']=[]\n                    for(var i = 0; i &lt; length; i++){\n                        sc.data['color'].push(color_dict[sc.data[tax_unit][i]])\n                    }\n                    sc.change.emit();\n                "},"id":"1065","type":"CustomJS"},{"attributes":{"children":[{"id":"1005"}]},"id":"1096","type":"Column"},{"attributes":{"children":[{"id":"1082"},{"id":"1083"}]},"id":"1097","type":"Row"},{"attributes":{},"id":"1010","type":"DataRange1d"},{"attributes":{"toolbar":{"id":"1133"}},"id":"1134","type":"ToolbarBox"},{"attributes":{"bottom_units":"screen","coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1032","type":"BoxAnnotation"},{"attributes":{"children":[{"id":"1004"},{"id":"1097"},{"id":"1081"},{"id":"1091"},{"id":"1093"},{"id":"1071"},{"id":"1073"}]},"id":"1098","type":"Column"},{"attributes":{"children":[{"id":"1066"},{"id":"1067"},{"id":"1068"},{"id":"1069"},{"id":"1070"},{"id":"1064"},{"id":"1094"}]},"id":"1099","type":"Column"},{"attributes":{},"id":"1012","type":"LinearScale"},{"attributes":{"children":[[{"id":"1096"},0,0],[{"id":"1098"},0,1],[{"id":"1099"},0,2]]},"id":"1132","type":"GridBox"},{"attributes":{"axis":{"id":"1016"},"coordinates":null,"group":null,"ticker":null},"id":"1019","type":"Grid"},{"attributes":{"toolbars":[{"id":"1035"}],"tools":[{"id":"1024"},{"id":"1025"},{"id":"1026"},{"id":"1027"},{"id":"1028"},{"id":"1029"},{"id":"1030"},{"id":"1031"},{"id":"1034"}]},"id":"1133","type":"ProxyToolbar"},{"attributes":{"args":{"data":{"id":"1003"},"gl":{"id":"1050"},"plot":[{"id":"1016"},{"id":"1020"}]},"code":"\n           var call_back_object = cb_obj.value;\n           data.data['x'] = data.data[call_back_object]\n           plot[0].axis_label = call_back_object;\n           data.change.emit();\n\n    "},"id":"1072","type":"CustomJS"},{"attributes":{"callback":null,"tooltips":[["stitle","@stitle"],["bitscore,pident","@bitscore, @pident"],["sacc RBH to qseqid","@sacc RBH to @qseqid "],["scomname","@scomnames"]]},"id":"1034","type":"HoverTool"},{"attributes":{"args":{"color_dict":{"Acaryochloridaceae":"#a1c9f4","Acaryochloridales":"#a1c9f4","Acaryochloris":"#a1c9f4","Aphanothecaceae":"#ffb482","Chroococcales":"#ffb482","Cyanobacteriota":"#a1c9f4","Cyanophyceae":"#a1c9f4","Cyanothecaceae":"#8de5a1","Cyanothece":"#ff9f9b","Geminocystaceae":"#ff9f9b","Gloeothece":"#ffb482","Gomontiellales":"#8de5a1","Merismopediaceae":"#d0bbff","Microcoleaceae":"#debb9b","Microcystaceae":"#fab0e4","Microcystis":"#cfcfcf","Nostoc":"#b9f2f0","Nostocaceae":"#cfcfcf","Nostocales":"#debb9b","Oscillatoriales":"#d0bbff","Parasynechococcus":"#ffb482","Picosynechococcus":"#d0bbff","Prochlorococcaceae":"#fffea3","Prochlorococcus":"#a1c9f4","Rippkaea":"#8de5a1","Synechococcaceae":"#b9f2f0","Synechococcales":"#ff9f9b","Synechococcus":"#8de5a1","Synechocystis":"#debb9b","Thermostichaceae":"#a1c9f4","Thermostichales":"#fab0e4","Thermostichus":"#ff9f9b","Thermosynechococcaceae":"#ffb482","Thermosynechococcus":"#d0bbff","Trichodesmium":"#fab0e4","Trichormus":"#fffea3"},"color_menu":{"id":"1064"},"menu_qseqids":{"id":"1004"},"sc":{"id":"1003"},"selected_taxonomy":{"family":{"id":"1069"},"genus":{"id":"1070"}},"source":{"id":"1002"},"tax_dict":{"class":["Cyanophyceae"],"family":["Merismopediaceae","Geminocystaceae","Acaryochloridaceae","Thermosynechococcaceae","Thermostichaceae","Synechococcaceae","Prochlorococcaceae","Nostocaceae","Microcystaceae","Aphanothecaceae","Microcoleaceae","Cyanothecaceae"],"genus":["Synechocystis","Picosynechococcus","Acaryochloris","Thermosynechococcus","Thermostichus","Synechococcus","Parasynechococcus","Nostoc","Microcystis","Gloeothece","Rippkaea","Trichodesmium","Trichormus","Cyanothece","Prochlorococcus"],"order":["Synechococcales","Chroococcales","Acaryochloridales","Thermostichales","Nostocales","Oscillatoriales","Gomontiellales"],"phylum":["Cyanobacteriota"]},"tax_unit":"order","xaxis_menu":{"id":"1071"},"yaxis_menu":{"id":"1073"}},"code":"\n\n                        var call_back_object = cb_obj.value \n\n\n                        var unique_class = []\n                        var unique_order = []\n                        var unique_family = []\n                        var unique_genus = []\n\n                        let keys = Object.keys(sc.data)\n                        for(var i = 0; i &lt; keys.length; i++){\n                            sc.data[keys[i]] = []\n                        }\n\n                        var taxid_arr = []\n                        for(var i = 0; i &lt; source.get_length(); i++){\n                            for(var j = 0; j &lt; call_back_object.length; j++){  \n                                for(var k = 0; k &lt; menu_qseqids.value.length; k++){\n                                    if(source.data['qseqid'][i] == menu_qseqids.value[k]){\n                                        if(source.data[tax_unit][i] == call_back_object[j]){\n\n                                            if(unique_order.includes(source.data['order'][i]) == false){\n                                                    unique_order.push(source.data['order'][i])\n                                                }\n\n                                            if(unique_class.includes(source.data['class'][i]) == false){\n                                                unique_class.push(source.data['class'][i])\n                                            }\n\n\n                                            if(unique_family.includes(source.data['family'][i]) == false){\n                                                unique_family.push(source.data['family'][i])\n                                            }\n\n                                            if(unique_genus.includes(source.data['genus'][i]) == false){\n                                                unique_genus.push(source.data['genus'][i])\n                                            }\n\n                                            for(var x = 0; x &lt; keys.length; x++){\n                                                if((keys[x] != 'x') &amp;&amp; (keys[x] != 'y') &amp;&amp; (keys[x] != 'color')){\n                                                    sc.data[keys[x]].push(source.data[keys[x]][i])\n\n                                                }\n                                            }\n\n                                            sc.data['color'].push(color_dict[source.data[color_menu.value][i]])\n                                            sc.data['x'].push(source.data[xaxis_menu.value][i])\n                                            sc.data['y'].push(source.data[yaxis_menu.value][i])\n                                            for(var l = 0;l&lt;tax_dict[color_menu.value].length;l++){\n                                                if(source.data[color_menu.value][i] == tax_dict[color_menu.value][l]){\n                                                    if(taxid_arr.includes(source.data['staxids'][i]) == false){\n                                                        taxid_arr.push(source.data['staxids'][i])\n                                                    }                                           \n                                                }                                           \n                                            }\n\n\n                                        }            \n                                    }\n                                }\n                            }\n                        }\n\n                        for(var key in selected_taxonomy) {\n                            if(key == 'order'){\n                                selected_taxonomy[key].options = unique_order\n                                selected_taxonomy[key].value = unique_order                                                        \n                            }\n\n                            if(key == 'class'){\n                                selected_taxonomy[key].options = unique_class\n                                selected_taxonomy[key].value = unique_class                                                        \n                            }\n\n                            if(key == 'family'){\n                                selected_taxonomy[key].options = unique_family\n                                selected_taxonomy[key].value = unique_family                                                        \n                            }\n\n                            if(key == 'genus'){\n                                selected_taxonomy[key].options = unique_genus\n                                selected_taxonomy[key].value = unique_genus                                                        \n                            }\n                        }\n\n                        sc.change.emit();\n                        \n                        "},"id":"1077","type":"CustomJS"},{"attributes":{"children":[{"id":"1132"},{"id":"1134"}]},"id":"1135","type":"Row"},{"attributes":{"axis_label":"bitscore","coordinates":null,"formatter":{"id":"1057"},"group":null,"major_label_policy":{"id":"1058"},"ticker":{"id":"1017"}},"id":"1016","type":"LinearAxis"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1072"}]},"options":["bitscore","pident","evalue","slen"],"title":"Select X axis elements","value":"bitscore"},"id":"1071","type":"Select"},{"attributes":{},"id":"1025","type":"ResetTool"},{"attributes":{},"id":"1054","type":"BasicTickFormatter"},{"attributes":{"axis_label":"pident","coordinates":null,"formatter":{"id":"1054"},"group":null,"major_label_policy":{"id":"1055"},"ticker":{"id":"1021"}},"id":"1020","type":"LinearAxis"},{"attributes":{"args":{"data":{"id":"1003"},"gl":{"id":"1050"},"plot":[{"id":"1016"},{"id":"1020"}]},"code":"\n           var call_back_object = cb_obj.value;\n           data.data['y'] = data.data[call_back_object]\n           plot[1].axis_label = call_back_object;\n           data.change.emit();\n\n    "},"id":"1074","type":"CustomJS"},{"attributes":{},"id":"1026","type":"SaveTool"},{"attributes":{},"id":"1021","type":"BasicTicker"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1074"}]},"options":["bitscore","pident","evalue","slen"],"title":"Select Y axis elements","value":"pident"},"id":"1073","type":"Select"},{"attributes":{"axis":{"id":"1020"},"coordinates":null,"dimension":1,"group":null,"ticker":null},"id":"1023","type":"Grid"},{"attributes":{},"id":"1055","type":"AllLabels"},{"attributes":{"overlay":{"id":"1032"}},"id":"1027","type":"BoxZoomTool"},{"attributes":{"overlay":{"id":"1033"}},"id":"1024","type":"LassoSelectTool"},{"attributes":{"args":{"color_dict":{"Acaryochloridaceae":"#a1c9f4","Acaryochloridales":"#a1c9f4","Acaryochloris":"#a1c9f4","Aphanothecaceae":"#ffb482","Chroococcales":"#ffb482","Cyanobacteriota":"#a1c9f4","Cyanophyceae":"#a1c9f4","Cyanothecaceae":"#8de5a1","Cyanothece":"#ff9f9b","Geminocystaceae":"#ff9f9b","Gloeothece":"#ffb482","Gomontiellales":"#8de5a1","Merismopediaceae":"#d0bbff","Microcoleaceae":"#debb9b","Microcystaceae":"#fab0e4","Microcystis":"#cfcfcf","Nostoc":"#b9f2f0","Nostocaceae":"#cfcfcf","Nostocales":"#debb9b","Oscillatoriales":"#d0bbff","Parasynechococcus":"#ffb482","Picosynechococcus":"#d0bbff","Prochlorococcaceae":"#fffea3","Prochlorococcus":"#a1c9f4","Rippkaea":"#8de5a1","Synechococcaceae":"#b9f2f0","Synechococcales":"#ff9f9b","Synechococcus":"#8de5a1","Synechocystis":"#debb9b","Thermostichaceae":"#a1c9f4","Thermostichales":"#fab0e4","Thermostichus":"#ff9f9b","Thermosynechococcaceae":"#ffb482","Thermosynechococcus":"#d0bbff","Trichodesmium":"#fab0e4","Trichormus":"#fffea3"},"color_menu":{"id":"1064"},"menu_qseqids":{"id":"1004"},"sc":{"id":"1003"},"selected_taxonomy":{"class":{"id":"1067"},"family":{"id":"1069"},"genus":{"id":"1070"},"order":{"id":"1068"}},"source":{"id":"1002"},"tax_dict":{"class":["Cyanophyceae"],"family":["Merismopediaceae","Geminocystaceae","Acaryochloridaceae","Thermosynechococcaceae","Thermostichaceae","Synechococcaceae","Prochlorococcaceae","Nostocaceae","Microcystaceae","Aphanothecaceae","Microcoleaceae","Cyanothecaceae"],"genus":["Synechocystis","Picosynechococcus","Acaryochloris","Thermosynechococcus","Thermostichus","Synechococcus","Parasynechococcus","Nostoc","Microcystis","Gloeothece","Rippkaea","Trichodesmium","Trichormus","Cyanothece","Prochlorococcus"],"order":["Synechococcales","Chroococcales","Acaryochloridales","Thermostichales","Nostocales","Oscillatoriales","Gomontiellales"],"phylum":["Cyanobacteriota"]},"tax_unit":"phylum","xaxis_menu":{"id":"1071"},"yaxis_menu":{"id":"1073"}},"code":"\n\n                        var call_back_object = cb_obj.value \n\n\n                        var unique_class = []\n                        var unique_order = []\n                        var unique_family = []\n                        var unique_genus = []\n\n                        let keys = Object.keys(sc.data)\n                        for(var i = 0; i &lt; keys.length; i++){\n                            sc.data[keys[i]] = []\n                        }\n\n                        var taxid_arr = []\n                        for(var i = 0; i &lt; source.get_length(); i++){\n                            for(var j = 0; j &lt; call_back_object.length; j++){  \n                                for(var k = 0; k &lt; menu_qseqids.value.length; k++){\n                                    if(source.data['qseqid'][i] == menu_qseqids.value[k]){\n                                        if(source.data[tax_unit][i] == call_back_object[j]){\n\n                                            if(unique_order.includes(source.data['order'][i]) == false){\n                                                    unique_order.push(source.data['order'][i])\n                                                }\n\n                                            if(unique_class.includes(source.data['class'][i]) == false){\n                                                unique_class.push(source.data['class'][i])\n                                            }\n\n\n                                            if(unique_family.includes(source.data['family'][i]) == false){\n                                                unique_family.push(source.data['family'][i])\n                                            }\n\n                                            if(unique_genus.includes(source.data['genus'][i]) == false){\n                                                unique_genus.push(source.data['genus'][i])\n                                            }\n\n                                            for(var x = 0; x &lt; keys.length; x++){\n                                                if((keys[x] != 'x') &amp;&amp; (keys[x] != 'y') &amp;&amp; (keys[x] != 'color')){\n                                                    sc.data[keys[x]].push(source.data[keys[x]][i])\n\n                                                }\n                                            }\n\n                                            sc.data['color'].push(color_dict[source.data[color_menu.value][i]])\n                                            sc.data['x'].push(source.data[xaxis_menu.value][i])\n                                            sc.data['y'].push(source.data[yaxis_menu.value][i])\n                                            for(var l = 0;l&lt;tax_dict[color_menu.value].length;l++){\n                                                if(source.data[color_menu.value][i] == tax_dict[color_menu.value][l]){\n                                                    if(taxid_arr.includes(source.data['staxids'][i]) == false){\n                                                        taxid_arr.push(source.data['staxids'][i])\n                                                    }                                           \n                                                }                                           \n                                            }\n\n\n                                        }            \n                                    }\n                                }\n                            }\n                        }\n\n                        for(var key in selected_taxonomy) {\n                            if(key == 'order'){\n                                selected_taxonomy[key].options = unique_order\n                                selected_taxonomy[key].value = unique_order                                                        \n                            }\n\n                            if(key == 'class'){\n                                selected_taxonomy[key].options = unique_class\n                                selected_taxonomy[key].value = unique_class                                                        \n                            }\n\n                            if(key == 'family'){\n                                selected_taxonomy[key].options = unique_family\n                                selected_taxonomy[key].value = unique_family                                                        \n                            }\n\n                            if(key == 'genus'){\n                                selected_taxonomy[key].options = unique_genus\n                                selected_taxonomy[key].value = unique_genus                                                        \n                            }\n                        }\n\n                        sc.change.emit();\n                        \n                        "},"id":"1075","type":"CustomJS"},{"attributes":{"args":{"color_dict":{"Acaryochloridaceae":"#a1c9f4","Acaryochloridales":"#a1c9f4","Acaryochloris":"#a1c9f4","Aphanothecaceae":"#ffb482","Chroococcales":"#ffb482","Cyanobacteriota":"#a1c9f4","Cyanophyceae":"#a1c9f4","Cyanothecaceae":"#8de5a1","Cyanothece":"#ff9f9b","Geminocystaceae":"#ff9f9b","Gloeothece":"#ffb482","Gomontiellales":"#8de5a1","Merismopediaceae":"#d0bbff","Microcoleaceae":"#debb9b","Microcystaceae":"#fab0e4","Microcystis":"#cfcfcf","Nostoc":"#b9f2f0","Nostocaceae":"#cfcfcf","Nostocales":"#debb9b","Oscillatoriales":"#d0bbff","Parasynechococcus":"#ffb482","Picosynechococcus":"#d0bbff","Prochlorococcaceae":"#fffea3","Prochlorococcus":"#a1c9f4","Rippkaea":"#8de5a1","Synechococcaceae":"#b9f2f0","Synechococcales":"#ff9f9b","Synechococcus":"#8de5a1","Synechocystis":"#debb9b","Thermostichaceae":"#a1c9f4","Thermostichales":"#fab0e4","Thermostichus":"#ff9f9b","Thermosynechococcaceae":"#ffb482","Thermosynechococcus":"#d0bbff","Trichodesmium":"#fab0e4","Trichormus":"#fffea3"},"color_menu":{"id":"1064"},"menu_qseqids":{"id":"1004"},"sc":{"id":"1003"},"selected_taxonomy":{"family":{"id":"1069"},"genus":{"id":"1070"},"order":{"id":"1068"}},"source":{"id":"1002"},"tax_dict":{"class":["Cyanophyceae"],"family":["Merismopediaceae","Geminocystaceae","Acaryochloridaceae","Thermosynechococcaceae","Thermostichaceae","Synechococcaceae","Prochlorococcaceae","Nostocaceae","Microcystaceae","Aphanothecaceae","Microcoleaceae","Cyanothecaceae"],"genus":["Synechocystis","Picosynechococcus","Acaryochloris","Thermosynechococcus","Thermostichus","Synechococcus","Parasynechococcus","Nostoc","Microcystis","Gloeothece","Rippkaea","Trichodesmium","Trichormus","Cyanothece","Prochlorococcus"],"order":["Synechococcales","Chroococcales","Acaryochloridales","Thermostichales","Nostocales","Oscillatoriales","Gomontiellales"],"phylum":["Cyanobacteriota"]},"tax_unit":"class","xaxis_menu":{"id":"1071"},"yaxis_menu":{"id":"1073"}},"code":"\n\n                        var call_back_object = cb_obj.value \n\n\n                        var unique_class = []\n                        var unique_order = []\n                        var unique_family = []\n                        var unique_genus = []\n\n                        let keys = Object.keys(sc.data)\n                        for(var i = 0; i &lt; keys.length; i++){\n                            sc.data[keys[i]] = []\n                        }\n\n                        var taxid_arr = []\n                        for(var i = 0; i &lt; source.get_length(); i++){\n                            for(var j = 0; j &lt; call_back_object.length; j++){  \n                                for(var k = 0; k &lt; menu_qseqids.value.length; k++){\n                                    if(source.data['qseqid'][i] == menu_qseqids.value[k]){\n                                        if(source.data[tax_unit][i] == call_back_object[j]){\n\n                                            if(unique_order.includes(source.data['order'][i]) == false){\n                                                    unique_order.push(source.data['order'][i])\n                                                }\n\n                                            if(unique_class.includes(source.data['class'][i]) == false){\n                                                unique_class.push(source.data['class'][i])\n                                            }\n\n\n                                            if(unique_family.includes(source.data['family'][i]) == false){\n                                                unique_family.push(source.data['family'][i])\n                                            }\n\n                                            if(unique_genus.includes(source.data['genus'][i]) == false){\n                                                unique_genus.push(source.data['genus'][i])\n                                            }\n\n                                            for(var x = 0; x &lt; keys.length; x++){\n                                                if((keys[x] != 'x') &amp;&amp; (keys[x] != 'y') &amp;&amp; (keys[x] != 'color')){\n                                                    sc.data[keys[x]].push(source.data[keys[x]][i])\n\n                                                }\n                                            }\n\n                                            sc.data['color'].push(color_dict[source.data[color_menu.value][i]])\n                                            sc.data['x'].push(source.data[xaxis_menu.value][i])\n                                            sc.data['y'].push(source.data[yaxis_menu.value][i])\n                                            for(var l = 0;l&lt;tax_dict[color_menu.value].length;l++){\n                                                if(source.data[color_menu.value][i] == tax_dict[color_menu.value][l]){\n                                                    if(taxid_arr.includes(source.data['staxids'][i]) == false){\n                                                        taxid_arr.push(source.data['staxids'][i])\n                                                    }                                           \n                                                }                                           \n                                            }\n\n\n                                        }            \n                                    }\n                                }\n                            }\n                        }\n\n                        for(var key in selected_taxonomy) {\n                            if(key == 'order'){\n                                selected_taxonomy[key].options = unique_order\n                                selected_taxonomy[key].value = unique_order                                                        \n                            }\n\n                            if(key == 'class'){\n                                selected_taxonomy[key].options = unique_class\n                                selected_taxonomy[key].value = unique_class                                                        \n                            }\n\n                            if(key == 'family'){\n                                selected_taxonomy[key].options = unique_family\n                                selected_taxonomy[key].value = unique_family                                                        \n                            }\n\n                            if(key == 'genus'){\n                                selected_taxonomy[key].options = unique_genus\n                                selected_taxonomy[key].value = unique_genus                                                        \n                            }\n                        }\n\n                        sc.change.emit();\n                        \n                        "},"id":"1076","type":"CustomJS"},{"attributes":{"coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"syncable":false,"xs_units":"screen","ys_units":"screen"},"id":"1033","type":"PolyAnnotation"},{"attributes":{"args":{"color_dict":{"Acaryochloridaceae":"#a1c9f4","Acaryochloridales":"#a1c9f4","Acaryochloris":"#a1c9f4","Aphanothecaceae":"#ffb482","Chroococcales":"#ffb482","Cyanobacteriota":"#a1c9f4","Cyanophyceae":"#a1c9f4","Cyanothecaceae":"#8de5a1","Cyanothece":"#ff9f9b","Geminocystaceae":"#ff9f9b","Gloeothece":"#ffb482","Gomontiellales":"#8de5a1","Merismopediaceae":"#d0bbff","Microcoleaceae":"#debb9b","Microcystaceae":"#fab0e4","Microcystis":"#cfcfcf","Nostoc":"#b9f2f0","Nostocaceae":"#cfcfcf","Nostocales":"#debb9b","Oscillatoriales":"#d0bbff","Parasynechococcus":"#ffb482","Picosynechococcus":"#d0bbff","Prochlorococcaceae":"#fffea3","Prochlorococcus":"#a1c9f4","Rippkaea":"#8de5a1","Synechococcaceae":"#b9f2f0","Synechococcales":"#ff9f9b","Synechococcus":"#8de5a1","Synechocystis":"#debb9b","Thermostichaceae":"#a1c9f4","Thermostichales":"#fab0e4","Thermostichus":"#ff9f9b","Thermosynechococcaceae":"#ffb482","Thermosynechococcus":"#d0bbff","Trichodesmium":"#fab0e4","Trichormus":"#fffea3"},"color_menu":{"id":"1064"},"menu_qseqids":{"id":"1004"},"sc":{"id":"1003"},"selected_taxonomy":{"genus":{"id":"1070"}},"source":{"id":"1002"},"tax_dict":{"class":["Cyanophyceae"],"family":["Merismopediaceae","Geminocystaceae","Acaryochloridaceae","Thermosynechococcaceae","Thermostichaceae","Synechococcaceae","Prochlorococcaceae","Nostocaceae","Microcystaceae","Aphanothecaceae","Microcoleaceae","Cyanothecaceae"],"genus":["Synechocystis","Picosynechococcus","Acaryochloris","Thermosynechococcus","Thermostichus","Synechococcus","Parasynechococcus","Nostoc","Microcystis","Gloeothece","Rippkaea","Trichodesmium","Trichormus","Cyanothece","Prochlorococcus"],"order":["Synechococcales","Chroococcales","Acaryochloridales","Thermostichales","Nostocales","Oscillatoriales","Gomontiellales"],"phylum":["Cyanobacteriota"]},"tax_unit":"family","xaxis_menu":{"id":"1071"},"yaxis_menu":{"id":"1073"}},"code":"\n\n                        var call_back_object = cb_obj.value \n\n\n                        var unique_class = []\n                        var unique_order = []\n                        var unique_family = []\n                        var unique_genus = []\n\n                        let keys = Object.keys(sc.data)\n                        for(var i = 0; i &lt; keys.length; i++){\n                            sc.data[keys[i]] = []\n                        }\n\n                        var taxid_arr = []\n                        for(var i = 0; i &lt; source.get_length(); i++){\n                            for(var j = 0; j &lt; call_back_object.length; j++){  \n                                for(var k = 0; k &lt; menu_qseqids.value.length; k++){\n                                    if(source.data['qseqid'][i] == menu_qseqids.value[k]){\n                                        if(source.data[tax_unit][i] == call_back_object[j]){\n\n                                            if(unique_order.includes(source.data['order'][i]) == false){\n                                                    unique_order.push(source.data['order'][i])\n                                                }\n\n                                            if(unique_class.includes(source.data['class'][i]) == false){\n                                                unique_class.push(source.data['class'][i])\n                                            }\n\n\n                                            if(unique_family.includes(source.data['family'][i]) == false){\n                                                unique_family.push(source.data['family'][i])\n                                            }\n\n                                            if(unique_genus.includes(source.data['genus'][i]) == false){\n                                                unique_genus.push(source.data['genus'][i])\n                                            }\n\n                                            for(var x = 0; x &lt; keys.length; x++){\n                                                if((keys[x] != 'x') &amp;&amp; (keys[x] != 'y') &amp;&amp; (keys[x] != 'color')){\n                                                    sc.data[keys[x]].push(source.data[keys[x]][i])\n\n                                                }\n                                            }\n\n                                            sc.data['color'].push(color_dict[source.data[color_menu.value][i]])\n                                            sc.data['x'].push(source.data[xaxis_menu.value][i])\n                                            sc.data['y'].push(source.data[yaxis_menu.value][i])\n                                            for(var l = 0;l&lt;tax_dict[color_menu.value].length;l++){\n                                                if(source.data[color_menu.value][i] == tax_dict[color_menu.value][l]){\n                                                    if(taxid_arr.includes(source.data['staxids'][i]) == false){\n                                                        taxid_arr.push(source.data['staxids'][i])\n                                                    }                                           \n                                                }                                           \n                                            }\n\n\n                                        }            \n                                    }\n                                }\n                            }\n                        }\n\n                        for(var key in selected_taxonomy) {\n                            if(key == 'order'){\n                                selected_taxonomy[key].options = unique_order\n                                selected_taxonomy[key].value = unique_order                                                        \n                            }\n\n                            if(key == 'class'){\n                                selected_taxonomy[key].options = unique_class\n                                selected_taxonomy[key].value = unique_class                                                        \n                            }\n\n                            if(key == 'family'){\n                                selected_taxonomy[key].options = unique_family\n                                selected_taxonomy[key].value = unique_family                                                        \n                            }\n\n                            if(key == 'genus'){\n                                selected_taxonomy[key].options = unique_genus\n                                selected_taxonomy[key].value = unique_genus                                                        \n                            }\n                        }\n\n                        sc.change.emit();\n                        \n                        "},"id":"1078","type":"CustomJS"},{"attributes":{},"id":"1057","type":"BasicTickFormatter"},{"attributes":{"data":{"bitscore":{"__ndarray__":"AAAAAADga0AAAAAAAKBlQAAAAAAAeItAAAAAAACgZ0AAAAAAACiOQAAAAAAAYGdAAAAAAABgZkAAAAAAAJBxQAAAAAAAQGRAAAAAAACojUAAAAAAAACDQAAAAAAAAGpAAAAAAACckEAAAAAAAOBmQAAAAAAA4GdAAAAAAACgZkAAAAAAAABbQAAAAAAAoGZAAAAAAADwi0AAAAAAAOBlQAAAAAAAaIhAAAAAAADgZEAAAAAAAOBkQAAAAAAAqIhAAAAAAABgZUAAAAAAAKBlQAAAAAAAwGRAAAAAAADAZEAAAAAAAGiIQAAAAAAAoGRAAAAAAACAZEAAAAAAAMiJQAAAAAAAYGVAAAAAAAAAZUAAAAAAAOBkQAAAAAAAgGVAAAAAAABgZUAAAAAAAEBlQAAAAAAAYGpAAAAAAABIi0AAAAAAAABmQAAAAAAAcItAAAAAAAAga0AAAAAAAICKQAAAAAAAQGtA","dtype":"float64","order":"little","shape":[45]},"class":["Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae"],"color":["#a1c9f4","#a1c9f4","#a1c9f4","#ffb482","#ffb482","#ffb482","#8de5a1","#ff9f9b","#ff9f9b","#ff9f9b","#d0bbff","#d0bbff","#d0bbff","#debb9b","#fab0e4","#cfcfcf","#cfcfcf","#cfcfcf","#cfcfcf","#cfcfcf","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#fffea3","#b9f2f0","#b9f2f0","#b9f2f0","#b9f2f0","#b9f2f0","#b9f2f0","#a1c9f4","#a1c9f4","#a1c9f4","#a1c9f4","#ffb482"],"family":["Acaryochloridaceae","Acaryochloridaceae","Acaryochloridaceae","Aphanothecaceae","Aphanothecaceae","Aphanothecaceae","Cyanothecaceae","Geminocystaceae","Geminocystaceae","Geminocystaceae","Merismopediaceae","Merismopediaceae","Merismopediaceae","Microcoleaceae","Microcystaceae","Nostocaceae","Nostocaceae","Nostocaceae","Nostocaceae","Nostocaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Prochlorococcaceae","Synechococcaceae","Synechococcaceae","Synechococcaceae","Synechococcaceae","Synechococcaceae","Synechococcaceae","Thermostichaceae","Thermostichaceae","Thermostichaceae","Thermostichaceae","Thermosynechococcaceae"],"genus":["Acaryochloris","Acaryochloris","Acaryochloris","Gloeothece","Rippkaea","Rippkaea","Cyanothece","Picosynechococcus","Picosynechococcus","Picosynechococcus","Synechocystis","Synechocystis","Synechocystis","Trichodesmium","Microcystis","Trichormus","Nostoc","Nostoc","Nostoc","Nostoc","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Prochlorococcus","Parasynechococcus","Parasynechococcus","Parasynechococcus","Synechococcus","Synechococcus","Synechococcus","Synechococcus","Synechococcus","Synechococcus","Thermostichus","Thermostichus","Thermostichus","Thermostichus","Thermosynechococcus"],"index":[6,7,8,22,24,23,27,3,4,5,0,1,2,25,21,26,18,19,20,28,37,36,35,32,31,29,40,39,42,41,43,17,16,15,38,30,33,34,13,14,11,12,10,44,9],"marker":["plus","triangle","square_dot","triangle","square_dot","triangle","triangle","plus","triangle","square_dot","plus","triangle","square_dot","triangle","triangle","triangle","plus","triangle","square_dot","triangle","square_dot","triangle","triangle","square_dot","triangle","triangle","triangle","triangle","square_dot","triangle","triangle","square_dot","triangle","plus","triangle","triangle","triangle","triangle","plus","square_dot","triangle","square_dot","plus","square_dot","plus"],"order":["Acaryochloridales","Acaryochloridales","Acaryochloridales","Chroococcales","Chroococcales","Chroococcales","Gomontiellales","Chroococcales","Chroococcales","Chroococcales","Synechococcales","Synechococcales","Synechococcales","Oscillatoriales","Chroococcales","Nostocales","Nostocales","Nostocales","Nostocales","Nostocales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Synechococcales","Thermostichales","Thermostichales","Thermostichales","Thermostichales","Acaryochloridales"],"phylum":["Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota"],"pident":{"__ndarray__":"PQrXo3CNRkDl0CLb+XZVQClcj8L1eFRAVOOlm8TQVkBxPQrXo4hWQPT91HjpDldAsp3vp8YzWEBMN4lBYNVIQGIQWDm0QFZAy6FFtvPNVkAAAAAAAABZQAAAAAAAAFlAAAAAAAAAWUCTGARWDgVXQDMzMzMzw1dABFYOLbJtVUA3iUFg5VBKQARWDi2ybVVAJzEIrBy6VEAAAAAAAABWQHNoke18f1JAPzVeuklkVUA/NV66SWRVQJzEILByCFNAVg4tsp23VUDHSzeJQfhVQPyp8dJNIlVAuB6F61HgVEAlBoGVQ+tSQOkmMQisDFRAeekmMQhMVECyne+nxlNTQMdLN4lB6FVAukkMAis3Q0CDwMqhRTZVQOXQItv5dlVAJzEIrBwKVUA3iUFg5YhVQJzEILByaERAPQrXo3BtVEBg5dAi2+lUQAIrhxbZDlVAke18PzUuRUBkO99PjQdUQLTIdr6fWkVA","dtype":"float64","order":"little","shape":[45]},"qseqid":["WP_010874241","WP_010874242","WP_010874243","WP_010874242","WP_010874243","WP_010874242","WP_010874242","WP_010874241","WP_010874242","WP_010874243","WP_010874241","WP_010874242","WP_010874243","WP_010874242","WP_010874242","WP_010874242","WP_010874241","WP_010874242","WP_010874243","WP_010874242","WP_010874243","WP_010874242","WP_010874242","WP_010874243","WP_010874242","WP_010874242","WP_010874242","WP_010874242","WP_010874243","WP_010874242","WP_010874242","WP_010874243","WP_010874242","WP_010874241","WP_010874242","WP_010874242","WP_010874242","WP_010874242","WP_010874241","WP_010874243","WP_010874242","WP_010874243","WP_010874241","WP_010874243","WP_010874241"],"sacc":["Q6L8L3","Q6L8L2","Q6L8L1","B7KEN6","Q8VL13","Q8VL14","B8HSU2","Q6L8L7","Q6L8L6","Q6L8L5","P74644","P74645","P74646","Q10Y25","B0JLH2","Q3MEE5","Q8YT42","Q8YT41","Q8YT40","B2IWG6","Q7V0C4","Q7V0C3","A2BY50","Q7V5W7","Q7V5W6","A2C735","Q319E4","Q46JC3","Q7VAN5","Q7VAN4","A9BBW6","Q7U8R3","Q7U8R4","Q7U8R5","A5GV19","A5GN76","Q0I803","Q5N595","Q79PF6","Q79PF4","Q6L8K0","Q6L8J9","Q6L8K1","Q8GGL1","Q79V62"],"scomnames":["Acaryochloris marina MBIC11017","Acaryochloris marina MBIC11017","Acaryochloris marina MBIC11017","Gloeothece citriformis PCC 7424","Rippkaea orientalis PCC 8801","Rippkaea orientalis PCC 8801","Cyanothece sp. PCC 7425","Synechococcus sp. PCC 7002","Synechococcus sp. PCC 7002","Synechococcus sp. PCC 7002","Synechocystis sp. PCC 6803 substr. Kazusa","Synechocystis sp. PCC 6803 substr. Kazusa","Synechocystis sp. PCC 6803 substr. Kazusa","Trichodesmium erythraeum IMS101","Microcystis aeruginosa NIES-843","Trichormus variabilis ATCC 29413","Nostoc sp. PCC 7120 = FACHB-418","Nostoc sp. PCC 7120 = FACHB-418","Nostoc sp. PCC 7120 = FACHB-418","Nostoc punctiforme PCC 73102","Prochlorococcus marinus subsp. pastoris str. CCMP1986","Prochlorococcus marinus subsp. pastoris str. CCMP1986","Prochlorococcus marinus str. MIT 9515","Prochlorococcus marinus str. MIT 9313","Prochlorococcus marinus str. MIT 9313","Prochlorococcus marinus str. MIT 9303","Prochlorococcus marinus str. MIT 9312","Prochlorococcus marinus str. NATL2A","Prochlorococcus marinus subsp. marinus str. CCMP1375","Prochlorococcus marinus subsp. marinus str. CCMP1375","Prochlorococcus marinus str. MIT 9211","Parasynechococcus marenigrum WH 8102","Parasynechococcus marenigrum WH 8102","Parasynechococcus marenigrum WH 8102","Synechococcus sp. RCC307","Synechococcus sp. WH 7803","Synechococcus sp. CC9311","Synechococcus elongatus PCC 6301","Synechococcus elongatus PCC 7942 = FACHB-805","Synechococcus elongatus PCC 7942 = FACHB-805","Thermostichus vulcanus","Thermostichus vulcanus","Thermostichus vulcanus","Thermostichus lividus","Thermosynechococcus vestitus BP-1"],"slen":[299,104,522,106,521,104,105,299,104,516,299,105,519,104,104,108,102,108,519,104,509,107,108,499,119,119,105,107,501,117,114,512,104,296,110,119,119,102,284,519,108,518,283,541,283],"staxids":[329726,329726,329726,65393,41431,41431,395961,32049,32049,32049,1111708,1111708,1111708,203124,449447,240292,103690,103690,103690,63737,59919,59919,167542,74547,74547,59922,74546,59920,167539,167539,93059,84588,84588,84588,316278,32051,64471,269084,1140,1140,32053,32053,32053,33070,197221],"stitle":["NaN","NaN","NaN","NaN","NaN","NaN","RecName: Full=Circadian clock oscillator protein KaiB [Cyanothece sp. PCC 7425]","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","NaN","RecName: Full=Circadian clock oscillator protein KaiA [Thermostichus vulcanus]","NaN","NaN"],"x":{"__ndarray__":"AAAAAADga0AAAAAAAKBlQAAAAAAAeItAAAAAAACgZ0AAAAAAACiOQAAAAAAAYGdAAAAAAABgZkAAAAAAAJBxQAAAAAAAQGRAAAAAAACojUAAAAAAAACDQAAAAAAAAGpAAAAAAACckEAAAAAAAOBmQAAAAAAA4GdAAAAAAACgZkAAAAAAAABbQAAAAAAAoGZAAAAAAADwi0AAAAAAAOBlQAAAAAAAaIhAAAAAAADgZEAAAAAAAOBkQAAAAAAAqIhAAAAAAABgZUAAAAAAAKBlQAAAAAAAwGRAAAAAAADAZEAAAAAAAGiIQAAAAAAAoGRAAAAAAACAZEAAAAAAAMiJQAAAAAAAYGVAAAAAAAAAZUAAAAAAAOBkQAAAAAAAgGVAAAAAAABgZUAAAAAAAEBlQAAAAAAAYGpAAAAAAABIi0AAAAAAAABmQAAAAAAAcItAAAAAAAAga0AAAAAAAICKQAAAAAAAQGtA","dtype":"float64","order":"little","shape":[45]},"y":{"__ndarray__":"PQrXo3CNRkDl0CLb+XZVQClcj8L1eFRAVOOlm8TQVkBxPQrXo4hWQPT91HjpDldAsp3vp8YzWEBMN4lBYNVIQGIQWDm0QFZAy6FFtvPNVkAAAAAAAABZQAAAAAAAAFlAAAAAAAAAWUCTGARWDgVXQDMzMzMzw1dABFYOLbJtVUA3iUFg5VBKQARWDi2ybVVAJzEIrBy6VEAAAAAAAABWQHNoke18f1JAPzVeuklkVUA/NV66SWRVQJzEILByCFNAVg4tsp23VUDHSzeJQfhVQPyp8dJNIlVAuB6F61HgVEAlBoGVQ+tSQOkmMQisDFRAeekmMQhMVECyne+nxlNTQMdLN4lB6FVAukkMAis3Q0CDwMqhRTZVQOXQItv5dlVAJzEIrBwKVUA3iUFg5YhVQJzEILByaERAPQrXo3BtVEBg5dAi2+lUQAIrhxbZDlVAke18PzUuRUBkO99PjQdUQLTIdr6fWkVA","dtype":"float64","order":"little","shape":[45]}},"selected":{"id":"1113"},"selection_policy":{"id":"1112"}},"id":"1002","type":"ColumnDataSource"},{"attributes":{"args":{"color_dict":{"Acaryochloridaceae":"#a1c9f4","Acaryochloridales":"#a1c9f4","Acaryochloris":"#a1c9f4","Aphanothecaceae":"#ffb482","Chroococcales":"#ffb482","Cyanobacteriota":"#a1c9f4","Cyanophyceae":"#a1c9f4","Cyanothecaceae":"#8de5a1","Cyanothece":"#ff9f9b","Geminocystaceae":"#ff9f9b","Gloeothece":"#ffb482","Gomontiellales":"#8de5a1","Merismopediaceae":"#d0bbff","Microcoleaceae":"#debb9b","Microcystaceae":"#fab0e4","Microcystis":"#cfcfcf","Nostoc":"#b9f2f0","Nostocaceae":"#cfcfcf","Nostocales":"#debb9b","Oscillatoriales":"#d0bbff","Parasynechococcus":"#ffb482","Picosynechococcus":"#d0bbff","Prochlorococcaceae":"#fffea3","Prochlorococcus":"#a1c9f4","Rippkaea":"#8de5a1","Synechococcaceae":"#b9f2f0","Synechococcales":"#ff9f9b","Synechococcus":"#8de5a1","Synechocystis":"#debb9b","Thermostichaceae":"#a1c9f4","Thermostichales":"#fab0e4","Thermostichus":"#ff9f9b","Thermosynechococcaceae":"#ffb482","Thermosynechococcus":"#d0bbff","Trichodesmium":"#fab0e4","Trichormus":"#fffea3"},"color_menu":{"id":"1064"},"menu_qseqids":{"id":"1004"},"sc":{"id":"1003"},"selected_taxonomy":{},"source":{"id":"1002"},"tax_dict":{"class":["Cyanophyceae"],"family":["Merismopediaceae","Geminocystaceae","Acaryochloridaceae","Thermosynechococcaceae","Thermostichaceae","Synechococcaceae","Prochlorococcaceae","Nostocaceae","Microcystaceae","Aphanothecaceae","Microcoleaceae","Cyanothecaceae"],"genus":["Synechocystis","Picosynechococcus","Acaryochloris","Thermosynechococcus","Thermostichus","Synechococcus","Parasynechococcus","Nostoc","Microcystis","Gloeothece","Rippkaea","Trichodesmium","Trichormus","Cyanothece","Prochlorococcus"],"order":["Synechococcales","Chroococcales","Acaryochloridales","Thermostichales","Nostocales","Oscillatoriales","Gomontiellales"],"phylum":["Cyanobacteriota"]},"tax_unit":"genus","xaxis_menu":{"id":"1071"},"yaxis_menu":{"id":"1073"}},"code":"\n\n                        var call_back_object = cb_obj.value \n\n\n                        var unique_class = []\n                        var unique_order = []\n                        var unique_family = []\n                        var unique_genus = []\n\n                        let keys = Object.keys(sc.data)\n                        for(var i = 0; i &lt; keys.length; i++){\n                            sc.data[keys[i]] = []\n                        }\n\n                        var taxid_arr = []\n                        for(var i = 0; i &lt; source.get_length(); i++){\n                            for(var j = 0; j &lt; call_back_object.length; j++){  \n                                for(var k = 0; k &lt; menu_qseqids.value.length; k++){\n                                    if(source.data['qseqid'][i] == menu_qseqids.value[k]){\n                                        if(source.data[tax_unit][i] == call_back_object[j]){\n\n                                            if(unique_order.includes(source.data['order'][i]) == false){\n                                                    unique_order.push(source.data['order'][i])\n                                                }\n\n                                            if(unique_class.includes(source.data['class'][i]) == false){\n                                                unique_class.push(source.data['class'][i])\n                                            }\n\n\n                                            if(unique_family.includes(source.data['family'][i]) == false){\n                                                unique_family.push(source.data['family'][i])\n                                            }\n\n                                            if(unique_genus.includes(source.data['genus'][i]) == false){\n                                                unique_genus.push(source.data['genus'][i])\n                                            }\n\n                                            for(var x = 0; x &lt; keys.length; x++){\n                                                if((keys[x] != 'x') &amp;&amp; (keys[x] != 'y') &amp;&amp; (keys[x] != 'color')){\n                                                    sc.data[keys[x]].push(source.data[keys[x]][i])\n\n                                                }\n                                            }\n\n                                            sc.data['color'].push(color_dict[source.data[color_menu.value][i]])\n                                            sc.data['x'].push(source.data[xaxis_menu.value][i])\n                                            sc.data['y'].push(source.data[yaxis_menu.value][i])\n                                            for(var l = 0;l&lt;tax_dict[color_menu.value].length;l++){\n                                                if(source.data[color_menu.value][i] == tax_dict[color_menu.value][l]){\n                                                    if(taxid_arr.includes(source.data['staxids'][i]) == false){\n                                                        taxid_arr.push(source.data['staxids'][i])\n                                                    }                                           \n                                                }                                           \n                                            }\n\n\n                                        }            \n                                    }\n                                }\n                            }\n                        }\n\n                        for(var key in selected_taxonomy) {\n                            if(key == 'order'){\n                                selected_taxonomy[key].options = unique_order\n                                selected_taxonomy[key].value = unique_order                                                        \n                            }\n\n                            if(key == 'class'){\n                                selected_taxonomy[key].options = unique_class\n                                selected_taxonomy[key].value = unique_class                                                        \n                            }\n\n                            if(key == 'family'){\n                                selected_taxonomy[key].options = unique_family\n                                selected_taxonomy[key].value = unique_family                                                        \n                            }\n\n                            if(key == 'genus'){\n                                selected_taxonomy[key].options = unique_genus\n                                selected_taxonomy[key].value = unique_genus                                                        \n                            }\n                        }\n\n                        sc.change.emit();\n                        \n                        "},"id":"1079","type":"CustomJS"},{"attributes":{},"id":"1058","type":"AllLabels"},{"attributes":{"js_property_callbacks":{"change:value":[{"id":"1080"}]},"options":["WP_010874241","WP_010874242","WP_010874243"],"title":"Select target query sequence","value":["WP_010874241","WP_010874242"]},"id":"1004","type":"MultiSelect"},{"attributes":{"data":{"bitscore":{"__ndarray__":"AAAAAADga0AAAAAAAKBlQAAAAAAAoGdAAAAAAABgZ0A=","dtype":"float64","order":"little","shape":[4]},"class":["Cyanophyceae","Cyanophyceae","Cyanophyceae","Cyanophyceae"],"color":["#a1c9f4","#a1c9f4","#ffb482","#ffb482"],"family":["Acaryochloridaceae","Acaryochloridaceae","Aphanothecaceae","Aphanothecaceae"],"genus":["Acaryochloris","Acaryochloris","Gloeothece","Rippkaea"],"index":[6,7,22,23],"marker":["plus","triangle","triangle","triangle"],"order":["Acaryochloridales","Acaryochloridales","Chroococcales","Chroococcales"],"phylum":["Cyanobacteriota","Cyanobacteriota","Cyanobacteriota","Cyanobacteriota"],"pident":{"__ndarray__":"PQrXo3CNRkDl0CLb+XZVQFTjpZvE0FZA9P3UeOkOV0A=","dtype":"float64","order":"little","shape":[4]},"qseqid":["WP_010874241","WP_010874242","WP_010874242","WP_010874242"],"sacc":["Q6L8L3","Q6L8L2","B7KEN6","Q8VL14"],"scomnames":["Acaryochloris marina MBIC11017","Acaryochloris marina MBIC11017","Gloeothece citriformis PCC 7424","Rippkaea orientalis PCC 8801"],"slen":[299,104,106,104],"staxids":[329726,329726,65393,41431],"stitle":["NaN","NaN","NaN","NaN"],"x":{"__ndarray__":"AAAAAADga0AAAAAAAKBlQAAAAAAAoGdAAAAAAABgZ0A=","dtype":"float64","order":"little","shape":[4]},"y":{"__ndarray__":"PQrXo3CNRkDl0CLb+XZVQFTjpZvE0FZA9P3UeOkOV0A=","dtype":"float64","order":"little","shape":[4]}},"selected":{"id":"1060"},"selection_policy":{"id":"1059"}},"id":"1003","type":"ColumnDataSource"},{"attributes":{"args":{"color_dict":{"Acaryochloridaceae":"#a1c9f4","Acaryochloridales":"#a1c9f4","Acaryochloris":"#a1c9f4","Aphanothecaceae":"#ffb482","Chroococcales":"#ffb482","Cyanobacteriota":"#a1c9f4","Cyanophyceae":"#a1c9f4","Cyanothecaceae":"#8de5a1","Cyanothece":"#ff9f9b","Geminocystaceae":"#ff9f9b","Gloeothece":"#ffb482","Gomontiellales":"#8de5a1","Merismopediaceae":"#d0bbff","Microcoleaceae":"#debb9b","Microcystaceae":"#fab0e4","Microcystis":"#cfcfcf","Nostoc":"#b9f2f0","Nostocaceae":"#cfcfcf","Nostocales":"#debb9b","Oscillatoriales":"#d0bbff","Parasynechococcus":"#ffb482","Picosynechococcus":"#d0bbff","Prochlorococcaceae":"#fffea3","Prochlorococcus":"#a1c9f4","Rippkaea":"#8de5a1","Synechococcaceae":"#b9f2f0","Synechococcales":"#ff9f9b","Synechococcus":"#8de5a1","Synechocystis":"#debb9b","Thermostichaceae":"#a1c9f4","Thermostichales":"#fab0e4","Thermostichus":"#ff9f9b","Thermosynechococcaceae":"#ffb482","Thermosynechococcus":"#d0bbff","Trichodesmium":"#fab0e4","Trichormus":"#fffea3"},"color_menu":{"id":"1064"},"sc":{"id":"1003"},"source":{"id":"1002"},"taxonomy_menus":[{"id":"1066"},{"id":"1067"},{"id":"1068"},{"id":"1069"},{"id":"1070"}],"xaxis_menu":{"id":"1071"},"yaxis_menu":{"id":"1073"}},"code":"\n\n        var tax_unit = color_menu.value;\n        var call_back_object = cb_obj.value;\n\n        let keys = Object.keys(sc.data)\n        for(var i = 0; i &lt; keys.length; i++){\n            sc.data[keys[i]] = []\n        }\n\n        var taxid_arr = []\n        for(var i = 0; i &lt; source.get_length(); i++){\n            for(var j = 0; j &lt; call_back_object.length; j++){\n\n\n                if(source.data['qseqid'][i] == call_back_object[j]){\n\n                     if(taxonomy_menus[0].value.includes(source.data['phylum'][i]) == true){\n                        if(taxonomy_menus[1].value.includes(source.data['class'][i]) == true){\n                            if(taxonomy_menus[2].value.includes(source.data['order'][i]) == true){\n                                if(taxonomy_menus[3].value.includes(source.data['family'][i]) == true){\n                                     if(taxonomy_menus[4].value.includes(source.data['genus'][i]) == true){\n                                       for(var x = 0; x &lt; keys.length; x++){\n                                            if((keys[x] != 'x') &amp;&amp; (keys[x] != 'y') &amp;&amp; (keys[x] != 'color')){\n                                                sc.data[keys[x]].push(source.data[keys[x]][i])\n                                            }\n                                        }\n\n                                        sc.data['color'].push(color_dict[source.data[color_menu.value][i]])\n                                        sc.data['x'].push(source.data[xaxis_menu.value][i])\n                                        sc.data['y'].push(source.data[yaxis_menu.value][i])\n                                        if(taxid_arr.includes(source.data['staxids'][i]) == false){\n                                            taxid_arr.push(source.data['staxids'][i])\n                                        }\n                                     }                               \n                                }\n                            }\n                        }\n                     }\n\n\n\n\n\n                }\n            }\n        }\n\n        sc.change.emit();\n        "},"id":"1080","type":"CustomJS"},{"attributes":{},"id":"1031","type":"PanTool"}],"root_ids":["1135"]},"title":"Bokeh Application","version":"2.4.3"}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('1292').textContent;
              const render_items = [{"docid":"cd4879f6-e1af-4619-82c3-d0685a686b47","root_ids":["1135"],"roots":{"1135":"02b01f92-eed3-40d7-9a63-7d72719eb694"}}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
  </body>
</html>